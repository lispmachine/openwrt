// SPDX-License-Identifier: GPL-2.0-or-later
/include/ "fsl/p1020si-pre.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/leds/common.h>
/ {
	model = "HP MSM466";
	compatible = "hp,msm466";

	aliases {
		led-boot = &led_power;
		led-failsafe = &led_power;
		led-running = &led_power;
		led-upgrade = &led_power;
		label-mac-device = &enet0;
	};

	leds {
		compatible = "gpio-leds";

		led_power: power {
			gpios = <&gpio0 0 0>;
			label = "msm466:green:power";
		};

		enet {
			gpios = <&gpio0 1 0>;
			label = "msm466:green:enet";
		};

		wifi1 {
			gpios = <&gpio0 2 0>;
			label = "msm466:green:radio1";
			linux,default-trigger = "phy0tpt";
		};

		wifi2 {
			gpios = <&gpio0 3 0>;
			label = "msm466:green:radio2";
			linux,default-trigger = "phy1tpt";
		};
	};

	chosen {
		bootargs-override = "console=ttyS0,115200";
	};

	memory {
		device_type = "memory";
	};

	board_lbc: lbc: localbus@ffe05000 {
		reg = <0x0 0xffe05000 0x0 0x1000>;
		ranges = <0x0 0x0 0x0 0xffa00000 0x100000>;

		nand@1,0 {
			#address-cells = <0x1>;
			#size-cells = <0x1>;
			compatible = "fsl,elbc-fcm-nand";
			reg = <0x01 0x00 0x40000>;
			bank-width = <0x2>;
			device-width = <0x1>;
			nand-ecc-mode = "none";

			partitions {
				compatible = "fixed-partitions";
				#address-cells = <1>;
				#size-cells = <1>;

				partition@0 {
					reg = <0x0 0x100000>;
					label = "u-boot";
					read-only;
				};

				partition@100000 {
					reg = <0x100000 0x1000000>;
					label = "kernel";
				};

				partition@1100000 {
					reg = <0x1100000 0x7230000>;
					label = "ubi";
				};

				partition@7340000 {
					reg = <0x7340000 0xcc0000>;
					label = "stock-jffs2";
					read-only;
				};
			};
		};
	};

	board_soc: soc: soc@ffe00000 {
		device_type = "soc";
		compatible = "fsl,p1020-immr", "simple-bus";
		ranges = <0x0 0x0 0xffe00000 0x100000>;
		bus-frequency = <0x0>;

		i2c@3000 {
			#address-cells = <0x1>;
			#size-cells = <0x0>;
			cell-index = <0x0>;
			compatible = "fsl-i2c";
			reg = <0x3000 0x100>;
			interrupts = <0x2b 0x2>;
			interrupt-parent = <0x2>;
			dfsrr;
			rtc@68 {
				compatible = "dallas,ds1339";
				reg = <0x68>;
			};
		};

		i2c@3100 {
			tpm@29 {
				compatible = "atmel,at97sc3204t";
				reg = <0x29>;
			};

			/* Most likely SoC boot config */
			eeprom@51 {
				compatible = "eeprom";
				reg = <0x51>;
			};
		};

		mdio@24000 {
			#address-cells = <0x1>;
			#size-cells = <0x0>;
			compatible = "fsl,etsec2-mdio";
			reg = <0x24000 0x1000 0xb0030 0x4>;
			phy0: ethernet-phy@0 {
				interrupt-parent = <0x2>;
				interrupts = <0x3 0x3>;
				reg = <0x0>;
				linux,phandle = <0x3>;
			};
		};

		mdio@25000 {
			status = "disabled";
		};

		mdio@26000 {
			status = "disabled";
		};

		enet0: ethernet@b0000 {
			status = "okay";
			model = "eTSEC";
			compatible = "fsl,etsec2-mdio";
			phy-handle = <&phy0>;
			phy-connection-type = "rgmii-id";
		};

		enet1: ethernet@b1000 {
			status = "disabled";
		};

		enet2: ethernet@b2000 {
			status = "disabled";
		};

		gpio0: gpio-controller@f000 {
			#gpio-cells = <0x2>;
			compatible = "fsl,mpc8572-gpio";
			reg = <0xf000 0x100>;
			interrupts = <0x2f 0x2>;
			interrupt-parent = <0x2>;
			gpio-controller;
			available = <0x3 0x5 0x8 0xa 0xb 0xc 0xd 0xf>;
		};

		usb@22000 {
			#address-cells = <0x1>;
			#size-cells = <0x0>;
			compatible = "fsl-usb2-dr";
			reg = <0x22000 0x1000>;
			interrupt-parent = <0x2>;
			interrupts = <0x1c 0x2>;
			phy_type = "ulpi";
		};

		usb@23000 {
			status = "disabled";
		};

		crypto@30000 {
			compatible = "fsl,sec3.3", "fsl,sec3.1", "fsl,sec3.0", "fsl,sec2.4", "fsl,sec2.2", "fsl,sec2.1", "fsl,sec2.0";
			reg = <0x30000 0x10000>;
			interrupts = <0x2d 0x2 0x3a 0x2>;
			interrupt-parent = <0x2>;
			fsl,num-channels = <0x4>;
			fsl,channel-fifo-len = <0x18>;
			fsl,exec-units-mask = <0x97c>;
			fsl,descriptor-types-mask = <0x3a30abf>;
			fsl,multi-host-mode = "dual";
			fsl,channel-remap = <0x1>;
		};
		pic@40000 {
			interrupt-controller;
			#address-cells = <0x0>;
			#interrupt-cells = <0x2>;
			reg = <0x40000 0x40000>;
			compatible = "chrp,open-pic";
			device_type = "open-pic";
			linux,phandle = <0x2>;
		};
		message@41400 {
			compatible = "fsl,p1020-msg", "fsl,mpic-msg";
			reg = <0x41400 0x200>;
			interrupts = <0xb0 0x2 0xb1 0x2 0xb2 0x2 0xb3 0x2>;
			interrupt-parent = <0x2>;
		};
		message@42400 {
			compatible = "fsl,p1020-msg", "fsl,mpic-msg";
			reg = <0x42400 0x200>;
			interrupts = <0xb4 0x2 0xb5 0x2 0xb6 0x2 0xb7 0x2>;
			interrupt-parent = <0x2>;
		};
		msi@41600 {
			compatible = "fsl,p1020-msi", "fsl,mpic-msi";
			reg = <0x41600 0x80>;
			msi-available-ranges = <0x0 0x100>;
			interrupts = <0xe0 0x0 0xe1 0x0 0xe2 0x0 0xe3 0x0 0xe4 0x0 0xe5 0x0 0xe6 0x0 0xe7 0x0>;
			interrupt-parent = <0x2>;
		};
		global-utilities@e0000 {
			compatible = "fsl,p2020-guts";
			reg = <0xe0000 0x1000>;
			fsl,has-rstcr;
		};
	};

	pci0: pcie@ffe09000 {
		reg = <0x0 0xffe09000 0x0 0x1000>;
		ranges = <0x2000000 0x0 0xa0000000 0x0 0xa0000000 0x0 0x20000000
		0x1000000 0x0 0x00000000 0x0 0xffc30000 0x0 0x10000>;
		pcie@0 {
			ranges = <0x2000000 0x0 0xa0000000
			0x2000000 0x0 0xa0000000
			0x0 0x20000000

			0x1000000 0x0 0x0
			0x1000000 0x0 0x0
			0x0 0x100000>;
		};
	};

	pci1: pcie@ffe0a000 {
		reg = <0x0 0xffe0a000 0x0 0x1000>;
		ranges = <0x2000000 0x0 0xc0000000 0x0 0xc0000000 0x0 0x20000000
		0x1000000 0x0 0x00000000 0x0 0xffc20000 0x0 0x10000>;
		pcie@0 {
			ranges = <0x2000000 0x0 0xc0000000
			0x2000000 0x0 0xc0000000
			0x0 0x20000000

			0x1000000 0x0 0x0
			0x1000000 0x0 0x0
			0x0 0x100000>;
		};
	};
};

/include/ "fsl/p1020si-post.dtsi"
